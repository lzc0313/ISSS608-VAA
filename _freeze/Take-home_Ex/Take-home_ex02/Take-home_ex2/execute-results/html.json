{
  "hash": "7921c39e88404a3ac67f1ad49a39c7c0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take Home Exercise 2: DataVis Makeover\"\ndate: \"Jan 26,2024\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n  message: false\noutput:\n  quarto::quarto_html_document:\n    self_contained: true\neditor: visual\n---\n\n\nFor this Data Visualization Makeover exercise, i have choose my classmates Xu Lin's work of his take home exercise 1, and i will try to make improvements on his work so that it can be an better visual analysis.\n\n# **1. Overview:**\n\n## Objective\n\nFor this exercise the objective is to look at the distribution of Singapore students' performance in mathematics, reading, and science, and the relationship between these subjects performances with schools, gender and socioeconomic status of the students.\n\n## Methods\n\nFor this Analysis, the average score of mathematics, reading, and science is used as benchmark to do the analysis and visualization. and also for schools, gender and socioeconomic status variables.\n\n## Limitations\n\nThe mean serves as merely one benchmark and might not be universally applicable due to its sensitivity to extreme values, which can skew the representation of a data set's central tendency. Moreover, our choice of data is informed by subjective interpretation, potentially leading to biased datasets because it reflects our preconceptions and possible exclusion of relevant data points.\n\n# 2 Import R package & Data\n\n## Install R package\n\nInstalling necessary R packages that will be needed for this exercise. To load the requried packages the code chunk below use pacman::p_load() function is used to unsure that the packages are load to the current R work environment.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(ggrepel, patchwork, \n               ggthemes, hrbrthemes,\n               tidyverse, haven, ggplot2, dplyr,ggstatsplot,tidyr) \n```\n:::\n\n\n## Import Data\n\nFor this exercise, we are only examining the Singapore students. So the data load in the below code chunk only contains\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstu_qqq_SG <- readRDS(\"C:/lzc0313/ISSS608-VAA/In-class_Ex/In-class_ex1/data/stu_qqq_SG.rds\")\n```\n:::\n\n\n## Prepare Data\n\nAfter examing the data, found that the subject scores are named as PV1MATH to PV10MATCH and also same for other two subjects. The below code chunks calculates the average of PV1 to PV10 for all three subject.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstu_qqq_SG_MRS <- stu_qqq_SG %>%\n  mutate(AVEMATH = (PV1MATH + PV2MATH + PV3MATH + PV4MATH + PV5MATH + PV6MATH + PV7MATH + PV8MATH + PV9MATH + PV10MATH ) / 10,\n         AVEREAD = (PV1READ + PV2READ + PV3READ + PV4READ + PV5READ + PV6READ + PV7READ + PV8READ + PV9READ + PV10READ )/ 10,\n         AVESCIE = (PV1SCIE + PV2SCIE + PV3SCIE + PV4SCIE + PV5SCIE + PV6SCIE + PV7SCIE + PV8SCIE + PV9SCIE + PV10SCIE )/ 10)\n```\n:::\n\n\n# Distribution of Three Subjects\n\nBefore doing any further analysis, it is always good to look at the distribution of the data, so we can look at the distribution of the three subjects using histograms.\n\n::: panel-tabset\n### Distribution\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_ex2_files/figure-html/distribution-plot-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-home_ex2_files/figure-html/distribution-plot-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-home_ex2_files/figure-html/distribution-plot-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-home_ex2_files/figure-html/distribution-plot-4.png){width=672}\n:::\n:::\n\n\n### codes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean_math <- mean(stu_qqq_SG_MRS$AVEMATH, na.rm = TRUE)\nmean_read <- mean(stu_qqq_SG_MRS$AVEREAD, na.rm = TRUE)\nmean_scie <- mean(stu_qqq_SG_MRS$AVESCIE, na.rm = TRUE)\n\np1 <- ggplot(data=stu_qqq_SG_MRS, \n             aes(x = AVEMATH )) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  geom_vline(xintercept = mean_math, color = \"black\", linetype = \"dashed\")+\n  annotate(\"text\", x =mean_math, y = Inf, label = paste(\"Mean:\", round(mean_math, 2)), vjust = 1, hjust = 1.5, color = \"red\") +\n  theme_gray() +\n  ggtitle(\"MATHEMATICS\") \n\np2 <- ggplot(data=stu_qqq_SG_MRS, \n             aes(x = AVEREAD )) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  geom_vline(xintercept = mean_read, color = \"black\", linetype = \"dashed\")+\n  annotate(\"text\", x =mean_read, y = Inf, label = paste(\"Mean:\", round(mean_read, 2)), vjust = 1, hjust = 1.5, color = \"red\") +\n  theme_gray() +\n  ggtitle(\"READING\") \n\np3 <- ggplot(data=stu_qqq_SG_MRS, \n             aes(x = AVESCIE )) +\n  geom_histogram(bins=20, \n                 boundary = 100,\n                 color=\"grey25\", \n                 fill=\"grey90\") +\n  geom_vline(xintercept = mean_scie, color = \"black\", linetype = \"dashed\")+\n  annotate(\"text\", x =mean_scie, y = Inf, label = paste(\"Mean:\", round(mean_scie, 2)), vjust = 1, hjust = 1.5, color = \"red\") +\n  theme_gray() +\n  ggtitle(\"SCIENCE\") \n\np4 <- ggplot(stu_qqq_SG_MRS) +\n  geom_density(aes(x = AVEMATH, fill = \"Mathematics\"), alpha = 0.5) +\n  geom_density(aes(x = AVEREAD, fill = \"Reading\"), alpha = 0.5) +\n  geom_density(aes(x = AVESCIE, fill = \"Science\"), alpha = 0.5) +\n  geom_vline(xintercept = mean_math, color = \"red\", linetype = \"dashed\") +\n  geom_vline(xintercept = mean_read, color = \"green\", linetype = \"dashed\") +\n  geom_vline(xintercept = mean_scie, color = \"blue\", linetype = \"dashed\") +\n  annotate(\"text\", x = mean_math, y = 0, label = paste(\"Mean Math:\", round(mean_math, 2)), hjust = 0, color = \"red\", size = 3, angle = 90, vjust = -0.5) +\n  annotate(\"text\", x = mean_read, y = 0, label = paste(\"Mean Read:\", round(mean_read, 2)), hjust = 0, color = \"green\", size = 3, angle = 90, vjust = -0.5) +\n  annotate(\"text\", x = mean_scie, y = 0, label = paste(\"Mean Scie:\", round(mean_scie, 2)), hjust = 0, color = \"blue\", size = 3, angle = 90, vjust = -0.5) +\n  ggtitle(\"Density Plot of Scores by Subject\") +\n  xlab(\"Scores\") +\n  ylab(\"Density\") +\n  scale_fill_manual(values = c(\"Mathematics\" = \"red\", \"Reading\" = \"green\", \"Science\" = \"blue\")) +\n  theme_minimal()\n```\n:::\n\n:::\n\nThe mathematics, reading, and science scores conform to a normal distribution. Since we are not analyzing data from other countries, there is no basis for comparison, which means we can only say that this is a set of normal data with no apparent anomalies. And from the graphs, we could see that for students performance in three subjects,math has the greatest average mean among three courses, and the next up higher is science. Reading the lowest.\n\n# Gender Relationship with Subject Scores\n\nIn this section the relationship of gender with different subjects will be analysed.\n\n::: panel-tabset\n### Boxplot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_ex2_files/figure-html/boxplot-1.png){width=672}\n:::\n:::\n\n\n### codes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstu_qqq_SG_MRS_filtered <- stu_qqq_SG_MRS %>%\n  filter(ST004D01T == 1 | ST004D01T == 2)\n\nmean_label <- function(x) {\n  return(as.character(round(mean(x, na.rm = TRUE), 2)))\n}\n\nformatted_mean <- function(x) {\n  sprintf(\"%.2f\", mean(x, na.rm = TRUE))\n}\n\noffset <- 5  # Adjust this value as needed for your data\n\np4 <- ggplot(data = stu_qqq_SG_MRS_filtered, aes(y = AVEMATH, x = factor(ST004D01T), fill = factor(ST004D01T))) +\n  geom_boxplot() +\n  scale_x_discrete(labels = c(\"Female\", \"Male\")) +\n  stat_summary(geom = \"point\", fun = mean, color = \"red\", size = 3) +\n  geom_text(aes(label = formatted_mean(AVEMATH)), y = mean_math + offset, color = \"black\", vjust = -1.5, size = 3) +\n  ggtitle(\"F vs M in Math\") +\n  guides(fill=FALSE) # This removes the legend for fill\n\np5 <- ggplot(data = stu_qqq_SG_MRS_filtered, aes(y = AVEREAD, x = factor(ST004D01T), fill = factor(ST004D01T))) +\n  geom_boxplot() +\n  scale_x_discrete(labels = c(\"Female\", \"Male\")) +\n  stat_summary(geom = \"point\", fun = mean, color = \"red\", size = 3) +\n  geom_text(aes(label = formatted_mean(AVEREAD)), y = mean_read + offset, color = \"black\", vjust = -1.5, size = 3) +\n  ggtitle(\"F vs M in Read\") +\n  guides(fill=FALSE) # This removes the legend for fill\n\np6 <- ggplot(data = stu_qqq_SG_MRS_filtered, aes(y = AVESCIE, x = factor(ST004D01T), fill = factor(ST004D01T))) +\n  geom_boxplot() +\n  scale_x_discrete(labels = c(\"Female\", \"Male\")) +\n  stat_summary(geom = \"point\", fun = mean, color = \"red\", size = 3) +\n  geom_text(aes(label = formatted_mean(AVESCIE)), y = mean_scie + offset, color = \"black\", vjust = -1.5, size = 3) +\n  ggtitle(\"F vs M in Scie\") +\n  guides(fill=FALSE) # This removes the legend for fill\n```\n:::\n\n:::\n\nThe boxplot reveals only minor differences between females and males. Males perform slightly better than females in mathematics, while females outperform males in reading. In science, the mean scores are nearly identical.\n\n# Socioeconomic Status Relationship with Subject Scores\n\nNext take a look at the Socioeconomic status relationship with different subject scores.\n\n::: panel-tabset\n### Scatter plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_ex2_files/figure-html/scatterp-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-home_ex2_files/figure-html/scatterp-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Take-home_ex2_files/figure-html/scatterp-3.png){width=672}\n:::\n:::\n\n\n### codes\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor1 <- round(cor(stu_qqq_SG_MRS$AVEMATH, stu_qqq_SG_MRS$ESCS, use = \"complete.obs\"), 2)\ncor2 <- round(cor(stu_qqq_SG_MRS$AVESCIE, stu_qqq_SG_MRS$ESCS, use = \"complete.obs\"), 2)\ncor3 <- round(cor(stu_qqq_SG_MRS$AVEREAD, stu_qqq_SG_MRS$ESCS, use = \"complete.obs\"), 2)\n\nif (!is.na(cor1) && !is.na(cor2) && !is.na(cor3)) {\n  p7 <- ggplot(data = stu_qqq_SG_MRS, aes(y = AVEMATH, x = ESCS)) +\n          geom_point(size = 0.1) +\n          geom_smooth(method = lm) + \n          annotate(\"text\", x = 2.5, y = 600, label = paste0(\"r = \", cor1), color = 'blue') +\n          theme_minimal()\n\n  p8 <- ggplot(data = stu_qqq_SG_MRS, aes(y = AVESCIE, x = ESCS)) +\n          geom_point(size = 0.1) +\n          geom_smooth(method = lm) +\n          annotate(\"text\", x = 2.5, y = 600, label = paste0(\"r = \", cor2), color = 'blue') + \n          theme_minimal()\n\n  p9 <- ggplot(data = stu_qqq_SG_MRS, aes(y = AVEREAD, x = ESCS)) +\n          geom_point(size = 0.1) +\n          geom_smooth(method = lm) + \n          annotate(\"text\", x = 2.5, y = 600, label = paste0(\"r = \", cor3), color = 'blue') +\n          theme_minimal()\n} else {\n  cat(\"Correlation could not be calculated due to insufficient complete cases.\")\n}\n```\n:::\n\n:::\n\nThe scatter plots demonstrate a dispersion across all socioeconomic levels, yet they reveal a consistent trend: the correlations between socioeconomic status and academic performance in all subjects are approximately 0.44. This indicates a modest yet positive relationship. Consequently, it can be inferred that students from higher socioeconomic backgrounds tend to achieve higher scores.\n\n# Schools Relationship with Subject Scores\n\nLastly, we analyse the relationship between different schools in singapore with subject scores.\n\n::: panel-tabset\n### Scatter plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Take-home_ex2_files/figure-html/boxp2-1.png){width=672}\n:::\n:::\n\n\n### codes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nschool_averages <- stu_qqq_SG_MRS %>%\n  group_by(CNTSCHID) %>%\n  summarise(\n    Average_AVEMATH = mean(AVEMATH, na.rm = TRUE),\n    Average_AVEREAD = mean(AVEREAD, na.rm = TRUE),\n    Average_AVECIE = mean(AVESCIE, na.rm = TRUE)\n  )\n\nschool_averages_long <- school_averages %>%\n  pivot_longer(\n    cols = starts_with(\"Average_\"),\n    names_to = \"Subject\",\n    values_to = \"Average_Score\"\n  )\n\noutliers_threshold <- function(data, var) {\n  Q1 <- quantile(data[[var]], 0.25, na.rm = TRUE)\n  Q3 <- quantile(data[[var]], 0.75, na.rm = TRUE)\n  IQR <- Q3 - Q1\n  lower <- Q1 - 1.5 * IQR\n  upper <- Q3 + 1.5 * IQR\n  data %>% filter((data[[var]] < lower) | (data[[var]] > upper))\n}\n\noutliers_data <- school_averages_long %>%\n  group_by(Subject) %>%\n  do(outliers_threshold(., \"Average_Score\"))\n\np10 <- ggplot(school_averages_long, aes(x = Subject, y = Average_Score, fill = Subject)) +\n  geom_boxplot() +\n  geom_point(aes(color = Subject), position = position_jitter(width = 0.2), alpha = 0.5) +\n  labs(title = \"Boxplot of Average Scores by Subject in Schools\", x = \"Subject\", y = \"Average Score\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n  geom_text_repel(\n    data = outliers_data,\n    aes(label = CNTSCHID),\n    box.padding = 0.35,\n    point.padding = 0.5,\n    segment.color = \"grey50\",\n    size = 3,\n    max.overlaps = 10  \n  ) +\n  guides(fill = \"none\") \np10\n```\n:::\n\n:::\n\nThe boxplot visualizes the distribution of average scores in Science, Mathematics, and Reading across various schools, revealing a similar median score for each subject but with Science showing a greater variability in performance. Outliers marked with school IDs suggest significant deviations from the norm, with some schools achieving notably higher or lower scores, potentially indicating disparities in educational quality, resource allocation, or socioeconomic factors affecting student performance. Identifying and understanding the underlying reasons for these outliers could be key to informing educational improvements and policies.\n",
    "supporting": [
      "Take-home_ex2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}